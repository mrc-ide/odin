<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discrete models using odin • odin</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Discrete models using odin">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">odin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/odin.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/discrete.html">Discrete models using odin</a>
    </li>
    <li>
      <a href="../articles/functions.html">Odin Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/odin">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Discrete models using odin</h1>
                        <h4 class="author">Thibaut Jombart, Rich FitzJohn</h4>
            
            <h4 class="date">2020-06-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/odin/blob/master/vignettes/discrete.Rmd"><code>vignettes/discrete.Rmd</code></a></small>
      <div class="hidden name"><code>discrete.Rmd</code></div>

    </div>

    
    
<div id="discrete-compartmental-models-in-a-nutshell" class="section level1">
<h1 class="hasAnchor">
<a href="#discrete-compartmental-models-in-a-nutshell" class="anchor"></a>Discrete compartmental models in a nutshell</h1>
<div id="from-continuous-to-discrete-time" class="section level2">
<h2 class="hasAnchor">
<a href="#from-continuous-to-discrete-time" class="anchor"></a>From continuous to discrete time</h2>
<p>In its simplest form, a SIR model is typically written in continuous time as:</p>
<p><span class="math display">\[
\frac{dS}{dt} = - \beta \frac{S_t I_t}{N_t}
\]</span></p>
<p><span class="math display">\[
\frac{dI}{dt} = \beta \frac{S_t I_t}{N_t} - \gamma I_t
\]</span></p>
<p><span class="math display">\[
\frac{dR}{dt} = \gamma I_t
\]</span></p>
<p>Where <span class="math inline">\(\beta\)</span> is an infection rate and <span class="math inline">\(\gamma\)</span> a removal rate, assuming ‘R’ stands for ‘recovered’, which can mean recovery or death.</p>
<p>For discrete time equivalent, we take a small time step <span class="math inline">\(t\)</span> (typically a day), and write the changes of individuals in each compartment as:</p>
<p><span class="math display">\[
S_{t+1} = S_t - \beta \frac{S_t I_t}{N_t}
\]</span></p>
<p><span class="math display">\[
I_{t+1} = I_t + \beta \frac{S_t I_t}{N_t} - \gamma I_t
\]</span></p>
<p><span class="math display">\[
R_{t+1} = R_t + \gamma I_t
\]</span></p>
</div>
<div id="stochastic-processes" class="section level2">
<h2 class="hasAnchor">
<a href="#stochastic-processes" class="anchor"></a>Stochastic processes</h2>
<p>The discrete model above remains deterministic: for given values of the rates <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>, dynamics will be fixed. It is fairly straightforward to convert this discrete model into a stochastic one: one merely needs to uses appropriate probability distributions to model the transfer of individuals across compartments. There are at least 3 types of such distributions which will be useful to consider.</p>
<div id="binomial-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#binomial-distribution" class="anchor"></a>Binomial distribution</h3>
<p>This distribution will be used to determine numbers of individuals <strong>leaving</strong> a given compartment. While we may be tempted to use a Poisson distribution with the rates specified in the equations above, this could lead to over-shooting, i.e. more individuals leaving a compartment than there actually are. To avoid infecting more people than there are susceptibles, we use a binomial distribution, with one draw for each individual in the compartment of interest. The workflow will be:</p>
<ol style="list-style-type: decimal">
<li><p>determine a <em>per-capita probability</em> of leaving the compartment, based on the original rates specified in the equations; if the rate at which each individual leaves a compartment is <span class="math inline">\(\lambda\)</span>, then the corresponding probability of this individual leaving the compartment in one time unit is <span class="math inline">\(p = 1 - e^{- \lambda}\)</span>.</p></li>
<li><p>determine the number of individuals leaving the compartment using a <em>Binomial</em> distribution, with one draw per individual and a probability <span class="math inline">\(p\)</span></p></li>
</ol>
<p>As an example, let us consider transition <span class="math inline">\(S \rightarrow I\)</span> in the SIR model. The overall rate at which this change happens is <span class="math inline">\(\beta \frac{S_t I_t}{N_t}\)</span>. The corresponding <em>per susceptible</em> rate is <span class="math inline">\(\beta \frac{I_t}{N_t}\)</span>. Therefore, the probability for an individual to move from <em>S</em> to <em>I</em> at time <span class="math inline">\(t\)</span> is <span class="math inline">\(p_{(S \rightarrow I), t} = 1 - e^{- \beta \frac{I_t}{N_t}}\)</span>.</p>
</div>
<div id="poisson-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#poisson-distribution" class="anchor"></a>Poisson distribution</h3>
<p>Poisson distributions will be useful when individuals enter a compartment at a given rate, from ‘the outside’. This could be birth or migration (for <span class="math inline">\(S\)</span>), or introduction of infections from an external reservoir (for <span class="math inline">\(I\)</span>), etc. The essential distinction with the previous process is that individuals are <em>not leaving</em> an existing compartment.</p>
<p>This case is simple to handle: one just needs to draw new individuals entering the compartment from a Poisson distribution with the rate directly coming from the equations.</p>
<p>For instance, let us now consider a variant of the SIR model where new infectious cases are imported at a constant rate <span class="math inline">\(\epsilon\)</span>. The only change to the equation is for the infected compartment:</p>
<p><span class="math display">\[
I_{t+1} = I_t + \beta \frac{S_t I_t}{N_t} + \epsilon - \gamma I_t
\]</span></p>
<p>where:</p>
<ul>
<li><p>individuals move from <span class="math inline">\(S\)</span> to <span class="math inline">\(I\)</span> according to a Binomial distribution <span class="math inline">\(\mathcal{B}(S_t, 1 - e^{- \beta \frac{I_t}{N_t}})\)</span></p></li>
<li><p>new infected individuals are imported according to a Poisson distribution <span class="math inline">\(\mathcal{P}(\epsilon)\)</span></p></li>
<li><p>individual move from <span class="math inline">\(I\)</span> to <span class="math inline">\(R\)</span> according to a Binomial distribution <span class="math inline">\(\mathcal{B}(I_t, 1 - e^{- \gamma})\)</span></p></li>
</ul>
</div>
<div id="multinomial-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#multinomial-distribution" class="anchor"></a>Multinomial distribution</h3>
<p>This distribution will be useful when individuals leaving a compartment are distributed over several compartments. The Multinomial distribution will be used to determine how many individuals end up in each compartment. Let us assume that individuals move from a compartment <span class="math inline">\(X\)</span> to compartments <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span>, at rates <span class="math inline">\(\lambda_A\)</span>, <span class="math inline">\(\lambda_B\)</span> and <span class="math inline">\(\lambda_C\)</span>. The workflow to handle these transitions will be:</p>
<ol style="list-style-type: decimal">
<li><p>determine the total number of individuals leaving <span class="math inline">\(X\)</span>; this is done by summing the rates (<span class="math inline">\(\lambda = \lambda_A + \lambda_B + \lambda_C\)</span>) to compute the <em>per capita</em> probability of leaving <span class="math inline">\(X\)</span> <span class="math inline">\((p_(X \rightarrow ...) = 1 - e^{- \lambda})\)</span>, and drawing the number of individuals leaving <span class="math inline">\(X\)</span> (<span class="math inline">\(n_{_(X \rightarrow ...)}\)</span>) from a binomial distribution <span class="math inline">\(n_{(X \rightarrow ...)} \sim B(X, p_(X \rightarrow ...))\)</span></p></li>
<li><p>compute relative probabilities of moving to the different compartments (using <span class="math inline">\(i\)</span> as a placeholder for <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>): <span class="math inline">\(p_i = \frac{\lambda_i}{\sum_i \lambda_i}\)</span></p></li>
<li><p>determine the numbers of individuals moving to <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> using a Multinomial distribution: <span class="math inline">\(n_{(X \rightarrow A, B, C)} \sim \mathcal{M}(n_{(X \rightarrow ...)}, p_A, p_B, p_C)\)</span></p></li>
</ol>
</div>
</div>
</div>
<div id="implementation-using-odin" class="section level1">
<h1 class="hasAnchor">
<a href="#implementation-using-odin" class="anchor"></a>Implementation using <code>odin</code>
</h1>
<div id="deterministic-sir-model" class="section level2">
<h2 class="hasAnchor">
<a href="#deterministic-sir-model" class="anchor"></a>Deterministic SIR model</h2>
<p>We start by loading the <code>odin</code> code for a discrete, stochastic SIR model:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">path_sir_model &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"examples/discrete_deterministic_sir.R"</span>, <span class="dt">package =</span> <span class="st">"odin"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co">## Core equations for transitions between compartments:</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(S) &lt;-<span class="st"> </span>S <span class="op">-</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>S <span class="op">*</span><span class="st"> </span>I <span class="op">/</span><span class="st"> </span>N</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(I) &lt;-<span class="st"> </span>I <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>S <span class="op">*</span><span class="st"> </span>I <span class="op">/</span><span class="st"> </span>N <span class="op">-</span><span class="st"> </span>gamma <span class="op">*</span><span class="st"> </span>I</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(R) &lt;-<span class="st"> </span>R <span class="op">+</span><span class="st"> </span>gamma <span class="op">*</span><span class="st"> </span>I</a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">## Total population size (odin will recompute this at each timestep:</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">## automatically)</span></a>
<a class="sourceLine" id="cb2-8" title="8">N &lt;-<span class="st"> </span>S <span class="op">+</span><span class="st"> </span>I <span class="op">+</span><span class="st"> </span>R</a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">## Initial states:</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw">initial</span>(S) &lt;-<span class="st"> </span>S_ini <span class="co"># will be user-defined</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw">initial</span>(I) &lt;-<span class="st"> </span>I_ini <span class="co"># will be user-defined</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="kw">initial</span>(R) &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">## User defined parameters - default in parentheses:</span></a>
<a class="sourceLine" id="cb2-16" title="16">S_ini &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb2-17" title="17">I_ini &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-18" title="18">beta &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb2-19" title="19">gamma &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.1</span>)</a></code></pre></div>
<p>As said in the previous vignette, remember this looks and parses like R code, but is not actually R code. Copy-pasting this in a R session will trigger errors.</p>
<p>We then use <code>odin</code> to compile this model:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">sir_generator &lt;-<span class="st"> </span>odin<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/odin/man/odin.html">odin</a></span>(path_sir_model)</a>
<a class="sourceLine" id="cb3-2" title="2">sir_generator</a></code></pre></div>
<pre><code>## function (beta = NULL, gamma = NULL, I_ini = NULL, S_ini = NULL, 
##     user = list(beta = beta, gamma = gamma, I_ini = I_ini, S_ini = S_ini), 
##     unused_user_action = NULL) 
## &lt;an 'odin_generator' function&gt;
##   use coef() to get information on user parameters</code></pre>
<p><strong>Note</strong>: this is the slow part (generation and then compilation of C code)! Which means for computer-intensive work, the number of times this is done should be minimized.</p>
<p>The returned object <code>sir_generator</code> is a function that will generate an instance of the model:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">x &lt;-<span class="st"> </span><span class="kw">sir_generator</span>()</a>
<a class="sourceLine" id="cb5-2" title="2">x</a></code></pre></div>
<pre><code>## &lt;odin_model&gt;
##   Public:
##     contents: function () 
##     initial: function (step) 
##     initialize: function (user = NULL, unused_user_action = NULL) 
##     ir: {"version":"1.0.5","config":{"base":"discrete_determinis ...
##     run: function (step, y = NULL, ..., use_names = TRUE, replicate = NULL) 
##     set_user: function (..., user = list(...), unused_user_action = NULL) 
##     transform_variables: function (y) 
##     update: function (step, y) 
##   Private:
##     core: list
##     discrete: TRUE
##     dll: discrete_deterministic_sir_5cce19c3
##     init: 1000 1 0
##     interpolate_t: NULL
##     n_out: 0
##     name: discrete_deterministic_sir
##     output_order: NULL
##     ptr: externalptr
##     update_metadata: function () 
##     use_dde: NULL
##     user: beta gamma I_ini S_ini
##     variable_order: list
##     ynames: step S I R</code></pre>
<p><code>x</code> is an <code>ode_model</code> object which can be used to generate dynamics of a discrete-time, deterministic SIR model. This is achieved using the function <code>x$run()</code>, providing time steps as single argument, e.g.:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">sir_col &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#8c8cd9"</span>, <span class="st">"#cc0044"</span>, <span class="st">"#999966"</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">x<span class="op">$</span><span class="kw">run</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>##       step         S        I         R
##  [1,]    0 1000.0000 1.000000 0.0000000
##  [2,]    1  999.8002 1.099800 0.1000000
##  [3,]    2  999.5805 1.209517 0.2099800
##  [4,]    3  999.3389 1.330125 0.3309317
##  [5,]    4  999.0734 1.462696 0.4639442
##  [6,]    5  998.7814 1.608403 0.6102138
##  [7,]    6  998.4604 1.768530 0.7710541
##  [8,]    7  998.1076 1.944486 0.9479071
##  [9,]    8  997.7198 2.137811 1.1423557
## [10,]    9  997.2937 2.350191 1.3561368
## [11,]   10  996.8254 2.583469 1.5911558</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">x_res &lt;-<span class="st"> </span>x<span class="op">$</span><span class="kw">run</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">200</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span>(x_res[, <span class="dv">1</span>], x_res[, <span class="dv">-1</span>], <span class="dt">xlab =</span> <span class="st">"Time"</span>, <span class="dt">ylab =</span> <span class="st">"Number of individuals"</span>,</a>
<a class="sourceLine" id="cb9-4" title="4">        <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">col =</span> sir_col, <span class="dt">lty =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> sir_col, <span class="dt">legend =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"R"</span>), <span class="dt">bty =</span> <span class="st">"n"</span>)</a></code></pre></div>
<div class="figure">
<img src="discrete_files/figure-html/sir-deterministic-1.png" alt="&lt;i&gt;An example of deterministic, discrete-time SIR model&lt;/i&gt;&lt;br&gt;" width="672"><p class="caption">
<i>An example of deterministic, discrete-time SIR model</i><br></p>
</div>
</div>
<div id="stochastic-sir-model" class="section level2">
<h2 class="hasAnchor">
<a href="#stochastic-sir-model" class="anchor"></a>Stochastic SIR model</h2>
<p>The stochastic equivalent of the previous model can be formulated in <code>odin</code> as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">path_sir_model_s &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"examples/discrete_stochastic_sir.R"</span>, <span class="dt">package =</span> <span class="st">"odin"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">## Core equations for transitions between compartments:</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(S) &lt;-<span class="st"> </span>S <span class="op">-</span><span class="st"> </span>n_SI</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(I) &lt;-<span class="st"> </span>I <span class="op">+</span><span class="st"> </span>n_SI <span class="op">-</span><span class="st"> </span>n_IR</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(R) &lt;-<span class="st"> </span>R <span class="op">+</span><span class="st"> </span>n_IR</a>
<a class="sourceLine" id="cb11-5" title="5"></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">## Individual probabilities of transition:</span></a>
<a class="sourceLine" id="cb11-7" title="7">p_SI &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>beta <span class="op">*</span><span class="st"> </span>I <span class="op">/</span><span class="st"> </span>N) <span class="co"># S to I</span></a>
<a class="sourceLine" id="cb11-8" title="8">p_IR &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>gamma) <span class="co"># I to R</span></a>
<a class="sourceLine" id="cb11-9" title="9"></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">## Draws from binomial distributions for numbers changing between</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">## compartments:</span></a>
<a class="sourceLine" id="cb11-12" title="12">n_SI &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(S, p_SI)</a>
<a class="sourceLine" id="cb11-13" title="13">n_IR &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(I, p_IR)</a>
<a class="sourceLine" id="cb11-14" title="14"></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">## Total population size</span></a>
<a class="sourceLine" id="cb11-16" title="16">N &lt;-<span class="st"> </span>S <span class="op">+</span><span class="st"> </span>I <span class="op">+</span><span class="st"> </span>R</a>
<a class="sourceLine" id="cb11-17" title="17"></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">## Initial states:</span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="kw">initial</span>(S) &lt;-<span class="st"> </span>S_ini</a>
<a class="sourceLine" id="cb11-20" title="20"><span class="kw">initial</span>(I) &lt;-<span class="st"> </span>I_ini</a>
<a class="sourceLine" id="cb11-21" title="21"><span class="kw">initial</span>(R) &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb11-22" title="22"></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="co">## User defined parameters - default in parentheses:</span></a>
<a class="sourceLine" id="cb11-24" title="24">S_ini &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb11-25" title="25">I_ini &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-26" title="26">beta &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb11-27" title="27">gamma &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.1</span>)</a></code></pre></div>
<p>We can use the same workflow as before to run the model, using 10 initial infected individuals (<code>I_ini = 10</code>):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">sir_s_generator &lt;-<span class="st"> </span>odin<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/odin/man/odin.html">odin</a></span>(path_sir_model_s)</a>
<a class="sourceLine" id="cb12-2" title="2">sir_s_generator</a></code></pre></div>
<pre><code>## function (beta = NULL, gamma = NULL, I_ini = NULL, S_ini = NULL, 
##     user = list(beta = beta, gamma = gamma, I_ini = I_ini, S_ini = S_ini), 
##     unused_user_action = NULL) 
## &lt;an 'odin_generator' function&gt;
##   use coef() to get information on user parameters</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">x &lt;-<span class="st"> </span><span class="kw">sir_s_generator</span>(<span class="dt">I_ini =</span> <span class="dv">10</span>)</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">x_res &lt;-<span class="st"> </span>x<span class="op">$</span><span class="kw">run</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-4" title="4"><span class="kw"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span>(x_res[, <span class="dv">1</span>], x_res[, <span class="dv">-1</span>], <span class="dt">xlab =</span> <span class="st">"Time"</span>, <span class="dt">ylab =</span> <span class="st">"Number of individuals"</span>,</a>
<a class="sourceLine" id="cb15-5" title="5">        <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">col =</span> sir_col, <span class="dt">lty =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-6" title="6"><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> sir_col, <span class="dt">legend =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"R"</span>), <span class="dt">bty =</span> <span class="st">"n"</span>)</a></code></pre></div>
<div class="figure">
<img src="discrete_files/figure-html/sir-stochastic_1-1.png" alt="&lt;i&gt;An example of stochastic, discrete-time SIR model&lt;/i&gt;&lt;br&gt;" width="672"><p class="caption">
<i>An example of stochastic, discrete-time SIR model</i><br></p>
</div>
<p>This gives us a single stochastic realisation of the model, which is of limited interest. As an alternative, we can generate a large number of replicates using arrays for each compartment:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">path_sir_model_s_a &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"examples/discrete_stochastic_sir_arrays.R"</span>, <span class="dt">package =</span> <span class="st">"odin"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">## Core equations for transitions between compartments:</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(S[]) &lt;-<span class="st"> </span>S[i] <span class="op">-</span><span class="st"> </span>n_SI[i]</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(I[]) &lt;-<span class="st"> </span>I[i] <span class="op">+</span><span class="st"> </span>n_SI[i] <span class="op">-</span><span class="st"> </span>n_IR[i]</a>
<a class="sourceLine" id="cb17-4" title="4"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(R[]) &lt;-<span class="st"> </span>R[i] <span class="op">+</span><span class="st"> </span>n_IR[i]</a>
<a class="sourceLine" id="cb17-5" title="5"></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">## Individual probabilities of transition:</span></a>
<a class="sourceLine" id="cb17-7" title="7">p_SI[] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>beta <span class="op">*</span><span class="st"> </span>I[i] <span class="op">/</span><span class="st"> </span>N[i])</a>
<a class="sourceLine" id="cb17-8" title="8">p_IR &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>gamma)</a>
<a class="sourceLine" id="cb17-9" title="9"></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">## Draws from binomial distributions for numbers changing between</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">## compartments:</span></a>
<a class="sourceLine" id="cb17-12" title="12">n_SI[] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(S[i], p_SI[i])</a>
<a class="sourceLine" id="cb17-13" title="13">n_IR[] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(I[i], p_IR)</a>
<a class="sourceLine" id="cb17-14" title="14"></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co">## Total population size</span></a>
<a class="sourceLine" id="cb17-16" title="16">N[] &lt;-<span class="st"> </span>S[i] <span class="op">+</span><span class="st"> </span>I[i] <span class="op">+</span><span class="st"> </span>R[i]</a>
<a class="sourceLine" id="cb17-17" title="17"></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co">## Initial states:</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="kw">initial</span>(S[]) &lt;-<span class="st"> </span>S_ini</a>
<a class="sourceLine" id="cb17-20" title="20"><span class="kw">initial</span>(I[]) &lt;-<span class="st"> </span>I_ini</a>
<a class="sourceLine" id="cb17-21" title="21"><span class="kw">initial</span>(R[]) &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb17-22" title="22"></a>
<a class="sourceLine" id="cb17-23" title="23"><span class="co">## User defined parameters - default in parentheses:</span></a>
<a class="sourceLine" id="cb17-24" title="24">S_ini &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb17-25" title="25">I_ini &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-26" title="26">beta &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb17-27" title="27">gamma &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb17-28" title="28"></a>
<a class="sourceLine" id="cb17-29" title="29"><span class="co">## Number of replicates</span></a>
<a class="sourceLine" id="cb17-30" title="30">nsim &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb17-31" title="31"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(N) &lt;-<span class="st"> </span>nsim</a>
<a class="sourceLine" id="cb17-32" title="32"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(S) &lt;-<span class="st"> </span>nsim</a>
<a class="sourceLine" id="cb17-33" title="33"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(I) &lt;-<span class="st"> </span>nsim</a>
<a class="sourceLine" id="cb17-34" title="34"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(R) &lt;-<span class="st"> </span>nsim</a>
<a class="sourceLine" id="cb17-35" title="35"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(p_SI) &lt;-<span class="st"> </span>nsim</a>
<a class="sourceLine" id="cb17-36" title="36"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(n_SI) &lt;-<span class="st"> </span>nsim</a>
<a class="sourceLine" id="cb17-37" title="37"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(n_IR) &lt;-<span class="st"> </span>nsim</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">sir_s_a_generator &lt;-<span class="st"> </span>odin<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/odin/man/odin.html">odin</a></span>(path_sir_model_s_a)</a>
<a class="sourceLine" id="cb18-2" title="2">sir_s_a_generator</a></code></pre></div>
<pre><code>## function (beta = NULL, gamma = NULL, I_ini = NULL, nsim = NULL, 
##     S_ini = NULL, user = list(beta = beta, gamma = gamma, I_ini = I_ini, 
##         nsim = nsim, S_ini = S_ini), unused_user_action = NULL) 
## &lt;an 'odin_generator' function&gt;
##   use coef() to get information on user parameters</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">x &lt;-<span class="st"> </span><span class="kw">sir_s_a_generator</span>()</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-2" title="2">sir_col_transp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(sir_col, <span class="st">"66"</span>)</a>
<a class="sourceLine" id="cb21-3" title="3">x_res &lt;-<span class="st"> </span>x<span class="op">$</span><span class="kw">run</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb21-4" title="4"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="kw"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span>(x_res[, <span class="dv">1</span>], x_res[, <span class="dv">-1</span>], <span class="dt">xlab =</span> <span class="st">"Time"</span>, <span class="dt">ylab =</span> <span class="st">"Number of individuals"</span>,</a>
<a class="sourceLine" id="cb21-6" title="6">        <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(sir_col_transp, <span class="dt">each =</span> <span class="dv">100</span>), <span class="dt">lty =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-7" title="7"><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"left"</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> sir_col, <span class="dt">legend =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"R"</span>), <span class="dt">bty =</span> <span class="st">"n"</span>)</a></code></pre></div>
<div class="figure">
<img src="discrete_files/figure-html/sir-stochastic_100-1.png" alt="&lt;i&gt;100 replicates of a stochastic, discrete-time SIR model&lt;/i&gt;&lt;br&gt;" width="672"><p class="caption">
<i>100 replicates of a stochastic, discrete-time SIR model</i><br></p>
</div>
</div>
<div id="a-stochastic-seirds-model" class="section level2">
<h2 class="hasAnchor">
<a href="#a-stochastic-seirds-model" class="anchor"></a>A stochastic SEIRDS model</h2>
<p>This model is a more complex version of the previous one, which we will use to illustrate the use of all distributions mentioned in the first part: Binomial, Poisson and Multinomial.</p>
<p>The model is contains the following compartments:</p>
<ul>
<li>
<span class="math inline">\(S\)</span>: susceptibles</li>
<li>
<span class="math inline">\(E\)</span>: exposed, i.e. infected but not yet contagious</li>
<li>
<span class="math inline">\(I_R\)</span>: infectious who will survive</li>
<li>
<span class="math inline">\(I_D\)</span>: infectious who will die</li>
<li>
<span class="math inline">\(R\)</span>: recovered</li>
<li>
<span class="math inline">\(D\)</span>: dead</li>
</ul>
<p>There are no birth of natural death processes in this model. Parameters are:</p>
<ul>
<li>
<span class="math inline">\(\beta\)</span>: rate of infection</li>
<li>
<span class="math inline">\(\delta\)</span>: rate at which symptoms appear (i.e inverse of mean incubation period)</li>
<li>
<span class="math inline">\(\gamma_R\)</span>: recovery rate</li>
<li>
<span class="math inline">\(\gamma_D\)</span>: death rate</li>
<li>
<span class="math inline">\(\mu\)</span>: case fatality ratio (proportion of cases who die)</li>
<li>
<span class="math inline">\(\epsilon\)</span>: import rate of infected individuals (applies to <span class="math inline">\(E\)</span> and <span class="math inline">\(I\)</span>)</li>
<li>
<span class="math inline">\(\omega\)</span>: rate waning immunity</li>
</ul>
<p>The model will be written as:</p>
<p><span class="math display">\[
S_{t+1} = S_t - \beta \frac{S_t (I_{R,t} + I_{D,t})}{N_t} + \omega R_t
\]</span></p>
<p><span class="math display">\[
E_{t+1} = E_t + \beta \frac{S_t (I_{R,t} + I_{D,t})}{N_t} - \delta E_t + \epsilon
\]</span></p>
<p><span class="math display">\[
I_{R,t+1} = I_{R,t} + \delta (1 - \mu) E_t - \gamma_R I_{R,t} + \epsilon
\]</span></p>
<p><span class="math display">\[
I_{D,t+1} = I_{D,t} + \delta \mu E_t - \gamma_D I_{D,t} + \epsilon
\]</span></p>
<p><span class="math display">\[
R_{t+1} = R_t + \gamma_R I_{R,t} - \omega R_t
\]</span></p>
<p><span class="math display">\[
D_{t+1} = D_t + \gamma_D I_{D,t}
\]</span></p>
<p>The formulation of the model in <code>odin</code> is:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">path_seirds_model &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"examples/discrete_stochastic_seirds.R"</span>, <span class="dt">package =</span> <span class="st">"odin"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co">## Core equations for transitions between compartments:</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(S) &lt;-<span class="st"> </span>S <span class="op">-</span><span class="st"> </span>n_SE <span class="op">+</span><span class="st"> </span>n_RS</a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(E) &lt;-<span class="st"> </span>E <span class="op">+</span><span class="st"> </span>n_SE <span class="op">-</span><span class="st"> </span>n_EI <span class="op">+</span><span class="st"> </span>n_import_E</a>
<a class="sourceLine" id="cb23-4" title="4"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(Ir) &lt;-<span class="st"> </span>Ir <span class="op">+</span><span class="st"> </span>n_EIr <span class="op">-</span><span class="st"> </span>n_IrR</a>
<a class="sourceLine" id="cb23-5" title="5"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(Id) &lt;-<span class="st"> </span>Id <span class="op">+</span><span class="st"> </span>n_EId <span class="op">-</span><span class="st"> </span>n_IdD</a>
<a class="sourceLine" id="cb23-6" title="6"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(R) &lt;-<span class="st"> </span>R <span class="op">+</span><span class="st"> </span>n_IrR <span class="op">-</span><span class="st"> </span>n_RS</a>
<a class="sourceLine" id="cb23-7" title="7"><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(D) &lt;-<span class="st"> </span>D <span class="op">+</span><span class="st"> </span>n_IdD</a>
<a class="sourceLine" id="cb23-8" title="8"></a>
<a class="sourceLine" id="cb23-9" title="9"><span class="co">## Individual probabilities of transition:</span></a>
<a class="sourceLine" id="cb23-10" title="10">p_SE &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>beta <span class="op">*</span><span class="st"> </span>I <span class="op">/</span><span class="st"> </span>N)</a>
<a class="sourceLine" id="cb23-11" title="11">p_EI &lt;-<span class="st">  </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>delta)</a>
<a class="sourceLine" id="cb23-12" title="12">p_IrR &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>gamma_R) <span class="co"># Ir to R</span></a>
<a class="sourceLine" id="cb23-13" title="13">p_IdD &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>gamma_D) <span class="co"># Id to d</span></a>
<a class="sourceLine" id="cb23-14" title="14">p_RS &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>omega) <span class="co"># R to S</span></a>
<a class="sourceLine" id="cb23-15" title="15"></a>
<a class="sourceLine" id="cb23-16" title="16"></a>
<a class="sourceLine" id="cb23-17" title="17"><span class="co">## Draws from binomial distributions for numbers changing between</span></a>
<a class="sourceLine" id="cb23-18" title="18"><span class="co">## compartments:</span></a>
<a class="sourceLine" id="cb23-19" title="19">n_SE &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(S, p_SE)</a>
<a class="sourceLine" id="cb23-20" title="20">n_EI &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(E, p_EI)</a>
<a class="sourceLine" id="cb23-21" title="21"></a>
<a class="sourceLine" id="cb23-22" title="22">n_EIrId[] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Multinom.html">rmultinom</a></span>(n_EI, p)</a>
<a class="sourceLine" id="cb23-23" title="23">p[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mu</a>
<a class="sourceLine" id="cb23-24" title="24">p[<span class="dv">2</span>] &lt;-<span class="st"> </span>mu</a>
<a class="sourceLine" id="cb23-25" title="25"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(p) &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb23-26" title="26"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(n_EIrId) &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb23-27" title="27">n_EIr &lt;-<span class="st"> </span>n_EIrId[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb23-28" title="28">n_EId &lt;-<span class="st"> </span>n_EIrId[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb23-29" title="29">n_IrR &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(Ir, p_IrR)</a>
<a class="sourceLine" id="cb23-30" title="30">n_IdD &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(Id, p_IdD)</a>
<a class="sourceLine" id="cb23-31" title="31"></a>
<a class="sourceLine" id="cb23-32" title="32">n_RS &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(R, p_RS)</a>
<a class="sourceLine" id="cb23-33" title="33"></a>
<a class="sourceLine" id="cb23-34" title="34">n_import_E &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(epsilon)</a>
<a class="sourceLine" id="cb23-35" title="35"></a>
<a class="sourceLine" id="cb23-36" title="36"><span class="co">## Total population size, and number of infecteds</span></a>
<a class="sourceLine" id="cb23-37" title="37">I &lt;-<span class="st"> </span>Ir <span class="op">+</span><span class="st"> </span>Id</a>
<a class="sourceLine" id="cb23-38" title="38">N &lt;-<span class="st"> </span>S <span class="op">+</span><span class="st"> </span>E <span class="op">+</span><span class="st"> </span>I <span class="op">+</span><span class="st"> </span>R <span class="op">+</span><span class="st"> </span>D</a>
<a class="sourceLine" id="cb23-39" title="39"></a>
<a class="sourceLine" id="cb23-40" title="40"><span class="co">## Initial states</span></a>
<a class="sourceLine" id="cb23-41" title="41"><span class="kw">initial</span>(S) &lt;-<span class="st"> </span>S_ini</a>
<a class="sourceLine" id="cb23-42" title="42"><span class="kw">initial</span>(E) &lt;-<span class="st"> </span>E_ini</a>
<a class="sourceLine" id="cb23-43" title="43"><span class="kw">initial</span>(Id) &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb23-44" title="44"><span class="kw">initial</span>(Ir) &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb23-45" title="45"><span class="kw">initial</span>(R) &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb23-46" title="46"><span class="kw">initial</span>(D) &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb23-47" title="47"></a>
<a class="sourceLine" id="cb23-48" title="48"><span class="co">## User defined parameters - default in parentheses:</span></a>
<a class="sourceLine" id="cb23-49" title="49">S_ini &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="dv">1000</span>) <span class="co"># susceptibles</span></a>
<a class="sourceLine" id="cb23-50" title="50">E_ini &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="dv">1</span>) <span class="co"># infected</span></a>
<a class="sourceLine" id="cb23-51" title="51">beta &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.3</span>) <span class="co"># infection rate</span></a>
<a class="sourceLine" id="cb23-52" title="52">delta &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.3</span>) <span class="co"># inverse incubation</span></a>
<a class="sourceLine" id="cb23-53" title="53">gamma_R &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.08</span>) <span class="co"># recovery rate</span></a>
<a class="sourceLine" id="cb23-54" title="54">gamma_D &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.12</span>) <span class="co"># death rate</span></a>
<a class="sourceLine" id="cb23-55" title="55">mu &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.7</span>) <span class="co"># CFR</span></a>
<a class="sourceLine" id="cb23-56" title="56">omega &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.01</span>) <span class="co"># rate of waning immunity</span></a>
<a class="sourceLine" id="cb23-57" title="57">epsilon &lt;-<span class="st"> </span><span class="kw">user</span>(<span class="fl">0.1</span>) <span class="co"># import case rate</span></a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">seirds_generator &lt;-<span class="st"> </span>odin<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/odin/man/odin.html">odin</a></span>(path_seirds_model)</a>
<a class="sourceLine" id="cb24-2" title="2">seirds_generator</a></code></pre></div>
<pre><code>## function (beta = NULL, delta = NULL, E_ini = NULL, epsilon = NULL, 
##     gamma_D = NULL, gamma_R = NULL, mu = NULL, omega = NULL, 
##     S_ini = NULL, user = list(beta = beta, delta = delta, E_ini = E_ini, 
##         epsilon = epsilon, gamma_D = gamma_D, gamma_R = gamma_R, 
##         mu = mu, omega = omega, S_ini = S_ini), unused_user_action = NULL) 
## &lt;an 'odin_generator' function&gt;
##   use coef() to get information on user parameters</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seirds_generator</span>()</a>
<a class="sourceLine" id="cb26-2" title="2"></a>
<a class="sourceLine" id="cb26-3" title="3"></a>
<a class="sourceLine" id="cb26-4" title="4">seirds_col &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#8c8cd9"</span>, <span class="st">"#e67300"</span>, <span class="st">"#d279a6"</span>, <span class="st">"#ff4d4d"</span>, <span class="st">"#999966"</span>, <span class="st">"#660000"</span>)</a>
<a class="sourceLine" id="cb26-5" title="5"></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb26-7" title="7">x_res &lt;-<span class="st"> </span>x<span class="op">$</span><span class="kw">run</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">365</span>)</a>
<a class="sourceLine" id="cb26-8" title="8"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb26-9" title="9"><span class="kw"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span>(x_res[, <span class="dv">1</span>], x_res[, <span class="dv">-1</span>], <span class="dt">xlab =</span> <span class="st">"Time"</span>, <span class="dt">ylab =</span> <span class="st">"Number of individuals"</span>,</a>
<a class="sourceLine" id="cb26-10" title="10">        <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">col =</span> seirds_col, <span class="dt">lty =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb26-11" title="11"><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"left"</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> seirds_col, <span class="dt">legend =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"Ir"</span>, <span class="st">"Id"</span>, <span class="st">"R"</span>, <span class="st">"D"</span>), <span class="dt">bty =</span> <span class="st">"n"</span>)</a></code></pre></div>
<p><img src="discrete_files/figure-html/seirds-1.png" width="672"></p>
<p>Several runs can be obtained without rewriting the model, for instance, to get 100 replicates:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">x_res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="dv">100</span>, x<span class="op">$</span><span class="kw">run</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">365</span>)[, <span class="dv">-1</span>]))</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(x_res)</a></code></pre></div>
<pre><code>## [1] 366 600</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">x_res[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a></code></pre></div>
<pre><code>##    S.1 E.1 Id.1 Ir.1 R.1 D.1  S.2 E.2 Id.2 Ir.2
## 1 1000   1    0    0   0   0 1000   1    0    0
## 2 1000   1    0    0   0   0 1000   1    0    0
## 3 1000   0    0    1   0   0 1000   2    0    0
## 4 1000   0    0    1   0   0 1000   1    1    0
## 5 1000   0    0    1   0   0 1000   1    1    0
## 6 1000   0    0    1   0   0 1000   0    2    0</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">seirds_col_transp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(seirds_col, <span class="st">"1A"</span>)</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">365</span>, x_res, <span class="dt">xlab =</span> <span class="st">"Time"</span>, <span class="dt">ylab =</span> <span class="st">"Number of individuals"</span>,</a>
<a class="sourceLine" id="cb31-4" title="4">        <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(seirds_col_transp, <span class="dv">100</span>), <span class="dt">lty =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-5" title="5"><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"right"</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> seirds_col,</a>
<a class="sourceLine" id="cb31-6" title="6">       <span class="dt">legend =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"Ir"</span>, <span class="st">"Id"</span>, <span class="st">"R"</span>, <span class="st">"D"</span>), <span class="dt">bty =</span> <span class="st">"n"</span>)</a></code></pre></div>
<div class="figure">
<img src="discrete_files/figure-html/seirds_100-1.png" alt="&lt;i&gt;100 replicates of a stochastic, discrete-time SEIRDS model&lt;/i&gt;&lt;br&gt;" width="672"><p class="caption">
<i>100 replicates of a stochastic, discrete-time SEIRDS model</i><br></p>
</div>
<p>It is then possible to explore the behaviour of the model using a simple function:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">check_model &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">t =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">365</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, ...,</a>
<a class="sourceLine" id="cb32-2" title="2">                        <span class="dt">legend_pos =</span> <span class="st">"topright"</span>) {</a>
<a class="sourceLine" id="cb32-3" title="3">  model &lt;-<span class="st"> </span><span class="kw">seirds_generator</span>(...)</a>
<a class="sourceLine" id="cb32-4" title="4">  col &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(seirds_col, <span class="st">"33"</span>)</a>
<a class="sourceLine" id="cb32-5" title="5"></a>
<a class="sourceLine" id="cb32-6" title="6">  res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(n, model<span class="op">$</span><span class="kw">run</span>(t)[, <span class="dv">-1</span>]))</a>
<a class="sourceLine" id="cb32-7" title="7">  opar &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb32-8" title="8">  <span class="kw"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span>(<span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(opar))</a>
<a class="sourceLine" id="cb32-9" title="9">  <span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-10" title="10">  <span class="kw"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span>(t, res, <span class="dt">xlab =</span> <span class="st">"Time"</span>, <span class="dt">ylab =</span> <span class="st">""</span>,  <span class="dt">type =</span> <span class="st">"l"</span>,</a>
<a class="sourceLine" id="cb32-11" title="11">          <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(col, n), <span class="dt">lty =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-12" title="12">  <span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="st">"Number of individuals"</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">3.5</span>, <span class="dt">las =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb32-13" title="13">  <span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(legend_pos, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> seirds_col,</a>
<a class="sourceLine" id="cb32-14" title="14">         <span class="dt">legend =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"Ir"</span>, <span class="st">"Id"</span>, <span class="st">"R"</span>, <span class="st">"D"</span>), <span class="dt">bty =</span> <span class="st">"n"</span>)</a>
<a class="sourceLine" id="cb32-15" title="15">}</a></code></pre></div>
<p>This is a sanity check with a null infection rate and no imported case:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">check_model</span>(<span class="dt">beta =</span> <span class="dv">0</span>, <span class="dt">epsilon =</span> <span class="dv">0</span>)</a></code></pre></div>
<div class="figure">
<img src="discrete_files/figure-html/unnamed-chunk-10-1.png" alt="&lt;i&gt;Stochastic SEIRDS model: sanity check with no infections&lt;/i&gt;&lt;br&gt;" width="672"><p class="caption">
<i>Stochastic SEIRDS model: sanity check with no infections</i><br></p>
</div>
<p>Another easy case: no importation, no waning immunity:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">check_model</span>(<span class="dt">epsilon =</span> <span class="dv">0</span>, <span class="dt">omega =</span> <span class="dv">0</span>)</a></code></pre></div>
<div class="figure">
<img src="discrete_files/figure-html/unnamed-chunk-11-1.png" alt="&lt;i&gt;Stochastic SEIRDS model: no importation or waning immunity&lt;/i&gt;&lt;br&gt;" width="672"><p class="caption">
<i>Stochastic SEIRDS model: no importation or waning immunity</i><br></p>
</div>
<p>A more nuanced case: persistence of the disease with limited import, waning immunity, low severity, larger population:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">check_model</span>(<span class="dt">t =</span> <span class="dv">0</span><span class="op">:</span>(<span class="dv">365</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>), <span class="dt">epsilon =</span> <span class="fl">0.1</span>, <span class="dt">beta =</span> <span class="fl">.2</span>, <span class="dt">omega =</span> <span class="fl">.01</span>,</a>
<a class="sourceLine" id="cb35-2" title="2">            <span class="dt">mu =</span> <span class="fl">0.005</span>, <span class="dt">S_ini =</span> <span class="fl">1e5</span>)</a></code></pre></div>
<div class="figure">
<img src="discrete_files/figure-html/unnamed-chunk-12-1.png" alt="&lt;i&gt;Stochastic SEIRDS model: endemic state in a larger population&lt;/i&gt;&lt;br&gt;" width="672"><p class="caption">
<i>Stochastic SEIRDS model: endemic state in a larger population</i><br></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#discrete-compartmental-models-in-a-nutshell">Discrete compartmental models in a nutshell</a><ul class="nav nav-pills nav-stacked">
<li><a href="#from-continuous-to-discrete-time">From continuous to discrete time</a></li>
      <li><a href="#stochastic-processes">Stochastic processes</a></li>
      </ul>
</li>
      <li>
<a href="#implementation-using-odin">Implementation using <code>odin</code></a><ul class="nav nav-pills nav-stacked">
<li><a href="#deterministic-sir-model">Deterministic SIR model</a></li>
      <li><a href="#stochastic-sir-model">Stochastic SIR model</a></li>
      <li><a href="#a-stochastic-seirds-model">A stochastic SEIRDS model</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Rich FitzJohn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
