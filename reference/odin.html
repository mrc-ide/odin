<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an odin model — odin • odin</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create an odin model — odin" />
<meta property="og:description" content="Create an odin model from a file, text string(s) or expression.
The odin_ version is a &quot;standard evaluation&quot; escape hatch." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">odin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/odin.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/discrete.html">Discrete models using odin</a>
    </li>
    <li>
      <a href="../articles/functions.html">Odin Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mrc-ide/odin">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an odin model</h1>
    <small class="dont-index">Source: <a href='https://github.com/mrc-ide/odin/blob/master/R/odin.R'><code>R/odin.R</code></a></small>
    <div class="hidden name"><code>odin.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create an odin model from a file, text string(s) or expression.
The <code>odin_</code> version is a "standard evaluation" escape hatch.</p>
    </div>

    <pre class="usage"><span class='fu'>odin</span>(<span class='no'>x</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>workdir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>validate</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>pretty</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>skip_cache</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>compiler_warnings</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>no_check_unused_equations</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>no_check_naked_index</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>odin_</span>(<span class='no'>x</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>workdir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>validate</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>pretty</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>skip_cache</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>compiler_warnings</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>no_check_unused_equations</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>no_check_naked_index</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Either the name of a file to read, a text string (if
length is greater than 1 elements will be joined with newlines)
or an expression.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical scalar indicating if the compilation should
be verbose.  Defaults to the value of the option
<code>odin.verbose</code> or <code>FALSE</code> otherwise.</p></td>
    </tr>
    <tr>
      <th>target</th>
      <td><p>Compilation target.  Options are "c" and "r",
defaulting to the option <code>odin.target</code> or "c" otherwise.</p></td>
    </tr>
    <tr>
      <th>workdir</th>
      <td><p>Directory to use for any generated files.  This is
only relevant for the "c" target.  Defaults to the value of the
option <code>odin.workdir</code> or <code><a href='https://rdrr.io/r/base/tempfile.html'>tempdir()</a></code> otherwise.</p></td>
    </tr>
    <tr>
      <th>validate</th>
      <td><p>Validate the model's intermediate representation
against the included schema.  Normally this is not needed and is
intended primarily for development use.  Defaults to the value
of the option <code>odin.validate</code> or <code>FALSE</code> otherwise.</p></td>
    </tr>
    <tr>
      <th>pretty</th>
      <td><p>Pretty-print the model's intermediate
representation.  Normally this is not needed and is intended
primarily for development use.  Defaults to the value of the
option <code>odin.pretty</code> or <code>FALSE</code> otherwise.</p></td>
    </tr>
    <tr>
      <th>skip_cache</th>
      <td><p>Skip odin's cache.  This might be useful if the
model appears not to compile when you would expect it to.
Hopefully this will not be needed often.  Defaults to the option
<code>odin.skip_cache</code> or <code>FALSE</code> otherwise.</p></td>
    </tr>
    <tr>
      <th>compiler_warnings</th>
      <td><p>Logical scalar indicating if compiler
warnings should be converted to R warnings.  If this is
<code>TRUE</code>, then if any compiler warnings are generated, the
compiler output will be displayed (regardless of the value of
<code>verbose</code>) within an R warning (suppressible via
<code>suppressWarnings</code> and catchable via <code>tryCatch</code>).  The
default is to default to <code>FALSE</code> unless the global option
<code>odin.compiler_warnings</code> is set to <code>TRUE</code> (set with
<code><a href='https://rdrr.io/r/base/options.html'>options(odin.compiler_warnings = TRUE)</a></code>).  The default may
change to <code>TRUE</code> in future.  Warnings are currently a mix
of ambiguous syntax in your model (worth fixing) and limitations
in the code that odin generates (which you can't fix but I will
get on to over time).  What is flagged will depend strongly on
your platform and what is in your <code>Makevars</code>.  I develop
odin with <code>-Wall -Wextra -pedantic</code> and still see warnings
with both gcc and clang.  The compiler output is very simple and
may not work on all platforms.  Defaults to the option
<code>odin.compiler_warnings</code> or <code>FALSE</code> otherwise.</p></td>
    </tr>
    <tr>
      <th>no_check_unused_equations</th>
      <td><p>If <code>TRUE</code>, then don't print
messages about unused variables.  Defaults to the option
<code>odin.no_check_unused_equations</code> or <code>FALSE</code> otherwise.</p></td>
    </tr>
    <tr>
      <th>no_check_naked_index</th>
      <td><p>If <code>TRUE</code>, then if an index
variable (<code>i</code>, <code>j</code>, ...) is used outside of an array
subset (e.g., <code>x[] &lt;- i</code>) then a notice is printed.  The
behaviour of this functionality changed in odin version
<code>0.2.0</code> and this flag is intended to notify users about the
change.  See <a href='https://github.com/mrc-ide/odin/issues/136'>https://github.com/mrc-ide/odin/issues/136</a>
for more information.  Defaults to the option
<code>odin.no_check_naked_index</code> or <code>FALSE</code> otherwise.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A function that can generate the model</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><em>Do not use <code>odin::odin</code> in a package; you almost
certainly want to use <code><a href='odin_package.html'>odin_package</a></code> instead; see the
<code>odin_package</code> vignette for more information.</em></p>
<p>A generated model can return information about itself;
<code><a href='odin_ir.html'>odin_ir</a></code></p>
    <h2 class="hasAnchor" id="user-parameters"><a class="anchor" href="#user-parameters"></a>User parameters</h2>

    


<p>If the model accepts user parameters, then the parameter to the
constructor or the <code>set_user</code> method can be used to control
the behaviour when unknown user actions are passed into the
model.Possible values are the strings <code>stop</code> (throw an
error), <code>warning</code> (issue a warning but keep going),
<code>message</code> (print a message and keep going) or <code>ignore</code>
(do nothing).  Defaults to the option
<code>odin.unused_user_action</code>, or <code>warning</code> otherwise.  The
default behaviour prior to odin version 0.2.0 was equivalent to
<code>ignore</code>.</p>
    <h2 class="hasAnchor" id="delay-equations-with-dde"><a class="anchor" href="#delay-equations-with-dde"></a>Delay equations with dde</h2>

    


<p>When generating a model one must chose between using the
<code>dde</code> package to solve the system or the default
<code>deSolve</code>.  Future versions may allow this to switch when
using <code>run</code>, but for now this requires tweaking the generated
code to a point where one must decide at generation.  <code>dde</code>
implements only the Dormand-Prince 5th order dense output solver,
with a delay equation solver that may perform better than the
solvers in deSolve.  For non-delay equations, <code>deSolve</code> is
very likely to outperform the simple solver implemented.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Compile the model; exp_decay here is an R6ClassGenerator and will</span>
<span class='co'>## generate instances of a model of exponential decay:</span>
<span class='no'>exp_decay</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>odin</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/odin/man/odin.html'>odin</a></span>({
  <span class='fu'><a href='https://rdrr.io/r/stats/deriv.html'>deriv</a></span>(<span class='no'>y</span>) <span class='kw'>&lt;-</span> -<span class='fl'>0.5</span> * <span class='no'>y</span>
  <span class='fu'>initial</span>(<span class='no'>y</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
}, <span class='kw'>target</span> <span class='kw'>=</span> <span class='st'>"r"</span>)</div><div class='output co'>#&gt; <span class='message'>Generating model in r</span></div><div class='input'>
<span class='co'>## Generate an instance; there are no parameters here so all instances</span>
<span class='co'>## are the same and this looks a bit pointless.  But this step is</span>
<span class='co'>## required because in general you don't want to have to compile the</span>
<span class='co'>## model every time it is used (so the generator will go in a</span>
<span class='co'>## package).</span>
<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'>exp_decay</span>()

<span class='co'>## Run the model for a series of times from 0 to 10:</span>
<span class='no'>t</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>10</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='fl'>101</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span>$<span class='fu'>run</span>(<span class='no'>t</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>y</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Time"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"y"</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>las</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='img'><img src='odin-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#user-parameters">User parameters</a></li>
      <li><a href="#delay-equations-with-dde">Delay equations with dde</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Rich FitzJohn</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rich FitzJohn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


